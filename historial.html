<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Historial de Compras</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body>

<div class="container my-5">
  <h1 class="text-center mb-4">Historial de Compras</h1>
  <div id="historial" class="mb-4"></div>
  <div class="text-center">
    <button id="clear-history" class="btn btn-danger">Vaciar Historial</button>
  </div>
</div>

<script>
  const historialContainer = document.getElementById('historial');
  const history = JSON.parse(localStorage.getItem('history')) || [];

  if (history.length === 0) {
    historialContainer.innerHTML = '<p class="text-center">No hay compras registradas.</p>';
  } else {
    history.forEach((compra, index) => {
      let productosHTML = '';
      compra.productos.forEach(item => {
        productosHTML += `
          <li>${item.titulo} - Cantidad: ${item.cantidad} - Precio unitario: ${item.precio}</li>
        `;
      });

      const compraCard = `
        <div class="card mb-4">
          <div class="card-header">
            Compra ${index + 1} - Fecha: ${compra.fecha}
          </div>
          <div class="card-body">
            <ul>
              ${productosHTML}
            </ul>
            <p class="fw-bold">Total: $${compra.total.toLocaleString()}</p>
          </div>
        </div>
      `;
      historialContainer.innerHTML += compraCard;
    });
  }

  // Vaciar historial
  document.getElementById('clear-history').addEventListener('click', () => {
    localStorage.removeItem('history');
    localStorage.removeItem('cart');
    historialContainer.innerHTML = '<p class="text-center">No hay compras registradas.</p>';
    alert('Historial borrado!');
  });
</script>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
